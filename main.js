!function(){"use strict";const e=".popup__form",t=".profile__info";class s{constructor(e,s){let{data:r,handleCardImageClick:i,handleCardDeleteClick:n,handleCardLikeClick:a}=e;this._data=r,this._name=r.name,this._link=r.link,this._likes=r.likes,this._id=r._id,this._userId=document.querySelector(t).id,this._ownerId=r.owner._id,this._templateSelector=s,this._handleCardImageClick=i,this._handleCardDeleteClick=n,this._handleCardLikeClick=a}createCard(){return this._card=this._getElement(),this._cardName=this._card.querySelector(".card__name"),this._cardImage=this._card.querySelector(".card__image"),this._cardLikeButton=this._card.querySelector(".card__like-button"),this._cardLikeCount=this._card.querySelector(".card__like-count"),this._cardDeleteButton=this._card.querySelector(".card__delete-button"),this._cardName.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._card.id=this._id,this._cardLikeCount.textContent=this._getLikeCount(this._data),this._findLikeStatus(),this._authenticateCardDelete(),this._setEventListeners(),this._card}_getElement(){return document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0)}_findLikeStatus(){this._isLiked=this._getLikedUserIds().includes(this._userId),this._isLiked&&this._toggleCardLikeButton()}_listenCardLikeButtonClick(){this._cardLikeButton.addEventListener("click",(()=>{this._handleCardLikeClick(this._id,this._isLiked)}))}updateCardLike(e){this._updateLikeCount(e),this._toggleCardLikeButton(),this._isLiked=!this._isLiked}_toggleCardLikeButton(){this._cardLikeButton.classList.toggle("card__like-button_clicked")}_getLikeCount(e){return e.likes.length.toString()}_updateLikeCount(e){this._cardLikeCount.textContent=this._getLikeCount(e)}_getLikedUserIds(){return this._likes.map((e=>e._id))}_authenticateCardDelete(){this._userId==this._ownerId&&this._showCardDeleteButton()}_showCardDeleteButton(){this._cardDeleteButton.classList.add("card__delete-button_visible")}_listenCardDeleteButtonClick(){this._cardDeleteButton.addEventListener("click",(()=>{this._handleCardDeleteClick({cardId:this._id})}))}_listenCardImageClick(){this._cardImage.addEventListener("click",(()=>{this._handleCardImageClick(this._data)}))}_setEventListeners(){this._listenCardLikeButtonClick(),this._listenCardDeleteButtonClick(),this._listenCardImageClick()}}class r{constructor(e,t){this._settings=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector)}enableValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._settings.inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._settings.inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent=""}}class i{constructor(e){var t,s;s=e=>{"Escape"===e.key&&this.close()},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._selector=e,this._element=document.querySelector(this._selector)}open(){this._element.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._element.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._element.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()})),this._element.addEventListener("click",(e=>{e.target.classList.contains("popup__close-button")&&this.close()}))}}class n extends i{constructor(t,s){let{handleSubmit:r}=s;super(t),this._handleSubmit=r,this._form=this._element.querySelector(e),this._submitButton=this._element.querySelector(".popup__submit-button"),this._submitButtonInitialText=this._submitButton.textContent,this._inputList=this._element.querySelectorAll(".popup__input")}close(){super.close(),this._form.reset()}getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonInitialText}setEventListeners(){super.setEventListeners(),this._element.addEventListener("submit",this._handleSubmit)}}const a=document.querySelector(".profile__edit-button"),o=document.querySelector(".profile__add-button"),d=document.querySelector(".profile__avatar-wrapper"),l={},h=new Headers({authorization:"a397cd37-5ffd-4cc9-a80f-9599578123c3","Content-Type":"application/json"}),u=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleServerResponse(e){return e.ok?e.json():Promise.reject(e.status)}_request(e,t){return fetch(e,t).then(this._handleServerResponse)}handleError(e){console.error(`Error caught in fetch API: ${e}`)}_getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{headers:this._headers})}_getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getAppInfo(){return Promise.all([this._getUserInfo(),this._getInitialCards()])}editUserInfo(e){let{name:t,about:s}=e;return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})})}addNewCard(e){let{name:t,link:s}=e;return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})})}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}addLike(e){return this._request(`${this._baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this._headers})}deleteLike(e){return this._request(`${this._baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this._headers})}editUserAvatar(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:h}),_=new class{constructor(){this._userName=document.querySelector(".profile__name"),this._userAbout=document.querySelector(".profile__about"),this._userAvatar=document.querySelector(".profile__avatar"),this._userInfo=document.querySelector(t)}getUserInfo(){return{name:this._userName.textContent,about:this._userAbout.textContent}}renderUserInfo(e){let{name:t,about:s,avatar:r,_id:i}=e;this._userName.textContent=t,this._userAbout.textContent=s,this._userAvatar.src=r,this._userInfo.id=i}},c=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._element=document.querySelector(t)}renderItems(e){e.reverse().forEach((e=>{this.addItem(e)}))}addItem(e){const t=this._renderer(e);this._element.prepend(t)}}({renderer:function(e){const t=new s({data:e,handleCardImageClick:e=>{m.open(e)},handleCardDeleteClick:e=>{g.setInputValues(e),g.open()},handleCardLikeClick:(e,s)=>{s?u.deleteLike(e).then((e=>{t.updateCardLike(e)})).catch(u.handleError):u.addLike(e).then((e=>{t.updateCardLike(e)})).catch(u.handleError)}},"#card-template");return t.createCard()}},".cards"),m=new class extends i{constructor(e){super(e),this._image=this._element.querySelector(".popup__image"),this._subtitle=this._element.querySelector(".popup__subtitle")}open(e){this._image.src=e.link,this._image.alt=`Image ${e.name}`,this._subtitle.textContent=e.name,super.open()}}(".popup_type_image"),p=new n(".popup_type_avatar",{handleSubmit:e=>{e.preventDefault(),p.renderLoading(!0);const t=p.getInputValues();u.editUserAvatar(t).then((e=>{_.renderUserInfo(e),p.close()})).catch(u.handleError).finally((()=>{p.renderLoading(!1)}))}}),C=new n(".popup_type_edit",{handleSubmit:e=>{e.preventDefault(),C.renderLoading(!0);const{name:t,about:s}=C.getInputValues();u.editUserInfo({name:t,about:s}).then((e=>{_.renderUserInfo(e),C.close()})).catch(u.handleError).finally((()=>{C.renderLoading(!1)}))}}),g=new n(".popup_type_delete",{handleSubmit:e=>{e.preventDefault();const{cardId:t}=g.getInputValues(),s=document.getElementById(t);u.deleteCard(t).then((()=>{s.remove(),g.close()})).catch(u.handleError)}}),k=new n(".popup_type_add",{handleSubmit:e=>{e.preventDefault(),k.renderLoading(!0,"Creating...");const{name:t,link:s}=k.getInputValues();u.addNewCard({name:t,link:s}).then((e=>{c.addItem(e),k.close()})).catch(u.handleError).finally((()=>{k.renderLoading(!1)}))}});var L;u.getAppInfo().then((e=>{let[t,s]=e;_.renderUserInfo(t),c.renderItems(s)})).catch(u.handleError),m.setEventListeners(),p.setEventListeners(),C.setEventListeners(),k.setEventListeners(),g.setEventListeners(),L={inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_inactive",inputErrorClass:"popup__input_error",errorClass:"popup__input-error-text_active"},Array.from(document.querySelectorAll(e)).forEach((e=>{const t=new r(L,e),s=e.getAttribute("name");l[s]=t,t.enableValidation()})),d.addEventListener("click",(()=>{l["avatar-form"].resetValidation(),p.open()})),a.addEventListener("click",(()=>{l["profile-form"].resetValidation(),function(){const e=_.getUserInfo();C.setInputValues(e)}(),C.open()})),o.addEventListener("click",(()=>{l["card-form"].resetValidation(),k.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBTSxHQUNqQyxJQWxIc0JrRixNQXVIOUJ4RSxFQUNHdUIsYUFDQVAsTUFBSyxJQUEyQixJQUF6QmlELEVBQVVRLEdBQVUsRUFDMUJwQyxFQUFLTSxlQUFlc0IsR0FDcEJyQixFQUFZSSxZQUFZeUIsRUFBVSxJQUVuQ2IsTUFBTTVELEVBQUlpQixhQUVid0MsRUFBaUJuRixvQkFDakJ5RixFQUFnQnpGLG9CQUNoQjZGLEVBQWlCN0Ysb0JBQ2pCZ0csRUFBYWhHLG9CQUNib0YsRUFBZ0JwRixvQkFuSWNrRyxFTDFFRixDQUMxQnJJLGNBQWUsZ0JBQ2ZFLHFCQUFzQix3QkFDdEJTLG9CQUFxQixnQ0FDckJZLGdCQUFpQixxQkFDakJDLFdBQVksa0NLc0VLM0IsTUFBTUMsS0FBS3BELFNBQVNxRCxpQkFBaUJ2RSxJQUM3QzZFLFNBQVNaLElBQ2hCLE1BQU04SSxFQUFZLElBQUloSixFQUFjOEksRUFBYzVJLEdBRTVDK0ksRUFBVy9JLEVBQVlnSixhQUFhLFFBRzFDaEYsRUFBZStFLEdBQVlELEVBQzNCQSxFQUFVcEksa0JBQWtCLElBZ0loQ3FELEVBQWtCL0UsaUJBQWlCLFNBQVMsS0FDMUNnRixFTGpMZ0IsZUtpTHlCakQsa0JBQ3pDb0gsRUFBZ0I1RixNQUFNLElBR3hCc0IsRUFBa0I3RSxpQkFBaUIsU0FBUyxLQUMxQ2dGLEVMckxpQixnQktxTHlCakQsa0JBbE01QyxXQUNFLE1BQU1rSSxFQUFXeEMsRUFBS0ssY0FDdEJ5QixFQUFpQjlFLGVBQWV3RixFQUNsQyxDQWdNRUMsR0FDQVgsRUFBaUJoRyxNQUFNLElBR3pCdUIsRUFBYzlFLGlCQUFpQixTQUFTLEtBQ3RDZ0YsRUwxTGMsYUswTHlCakQsa0JBQ3ZDMkgsRUFBYW5HLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTZXR0aW5ncyBmb3IgZm9ybSB2YWxpZGF0aW9uXHJcbmV4cG9ydCBjb25zdCBmb3JtU2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fc3VibWl0LWJ1dHRvbl9pbmFjdGl2ZVwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dC1lcnJvci10ZXh0X2FjdGl2ZVwiLFxyXG59O1xyXG5cclxuLy8gU2VsZWN0b3JzXHJcbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XHJcbiAgY2FyZHNDb250YWluZXI6IFwiLmNhcmRzXCIsXHJcbiAgY2FyZFRlbXBsYXRlOiBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcbiAgY2FyZDogXCIuY2FyZFwiLFxyXG4gIGNhcmROYW1lOiBcIi5jYXJkX19uYW1lXCIsXHJcbiAgY2FyZEltYWdlOiBcIi5jYXJkX19pbWFnZVwiLFxyXG4gIGNhcmRMaWtlQnV0dG9uOiBcIi5jYXJkX19saWtlLWJ1dHRvblwiLFxyXG4gIGNhcmRMaWtlQnV0dG9uQWN0aXZlQ2xhc3M6IFwiY2FyZF9fbGlrZS1idXR0b25fY2xpY2tlZFwiLFxyXG4gIGNhcmRMaWtlQ291bnQ6IFwiLmNhcmRfX2xpa2UtY291bnRcIixcclxuICBjYXJkRGVsZXRlQnV0dG9uOiBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIsXHJcbiAgY2FyZERlbGV0ZUJ1dHRvblZpc2libGVDbGFzczogXCJjYXJkX19kZWxldGUtYnV0dG9uX3Zpc2libGVcIixcclxuICBwb3B1cEltYWdlOiBcIi5wb3B1cF90eXBlX2ltYWdlXCIsXHJcbiAgZWRpdEF2YXRhclBvcHVwOiBcIi5wb3B1cF90eXBlX2F2YXRhclwiLFxyXG4gIGVkaXRQcm9maWxlUG9wdXA6IFwiLnBvcHVwX3R5cGVfZWRpdFwiLFxyXG4gIGFkZENhcmRQb3B1cDogXCIucG9wdXBfdHlwZV9hZGRcIixcclxuICBkZWxldGVDYXJkUG9wdXA6IFwiLnBvcHVwX3R5cGVfZGVsZXRlXCIsXHJcbiAgcG9wdXBGb3JtOiBcIi5wb3B1cF9fZm9ybVwiLFxyXG4gIHBvcHVwSW5wdXQ6IFwiLnBvcHVwX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvbjogXCIucG9wdXBfX3N1Ym1pdC1idXR0b25cIixcclxuICB1c2VyTmFtZTogXCIucHJvZmlsZV9fbmFtZVwiLFxyXG4gIHVzZXJBYm91dDogXCIucHJvZmlsZV9fYWJvdXRcIixcclxuICB1c2VyQXZhdGFyOiBcIi5wcm9maWxlX19hdmF0YXJcIixcclxuICB1c2VySW5mbzogXCIucHJvZmlsZV9faW5mb1wiLFxyXG4gIGVkaXRBdmF0YXJPdmVybGF5OiBcIi5wcm9maWxlX19hdmF0YXItd3JhcHBlclwiLFxyXG4gIGVkaXRCdXR0b246IFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIsXHJcbiAgYWRkQnV0dG9uOiBcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIsXHJcbiAgYXZhdGFyRm9ybU5hbWU6IFwiYXZhdGFyLWZvcm1cIixcclxuICBwcm9maWxlRm9ybU5hbWU6IFwicHJvZmlsZS1mb3JtXCIsXHJcbiAgY2FyZEZvcm1OYW1lOiBcImNhcmQtZm9ybVwiLFxyXG59O1xyXG4iLCJpbXBvcnQgeyBzZWxlY3RvcnMgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHsgZGF0YSwgaGFuZGxlQ2FyZEltYWdlQ2xpY2ssIGhhbmRsZUNhcmREZWxldGVDbGljaywgaGFuZGxlQ2FyZExpa2VDbGljayB9LFxyXG4gICAgdGVtcGxhdGVTZWxlY3RvclxyXG4gICkge1xyXG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl91c2VySWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy51c2VySW5mbykuaWQ7XHJcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRJbWFnZUNsaWNrID0gaGFuZGxlQ2FyZEltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlQ2xpY2sgPSBoYW5kbGVDYXJkRGVsZXRlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZUNsaWNrID0gaGFuZGxlQ2FyZExpa2VDbGljaztcclxuICB9XHJcblxyXG4gIGNyZWF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkID0gdGhpcy5fZ2V0RWxlbWVudCgpO1xyXG5cclxuICAgIHRoaXMuX2NhcmROYW1lID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5jYXJkTmFtZSk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLmNhcmRJbWFnZSk7XHJcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMuY2FyZExpa2VCdXR0b24pO1xyXG4gICAgdGhpcy5fY2FyZExpa2VDb3VudCA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMuY2FyZExpa2VDb3VudCk7XHJcbiAgICB0aGlzLl9jYXJkRGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBzZWxlY3RvcnMuY2FyZERlbGV0ZUJ1dHRvblxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkTmFtZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZC5pZCA9IHRoaXMuX2lkO1xyXG5cclxuICAgIHRoaXMuX2NhcmRMaWtlQ291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9nZXRMaWtlQ291bnQodGhpcy5fZGF0YSk7XHJcbiAgICB0aGlzLl9maW5kTGlrZVN0YXR1cygpO1xyXG4gICAgdGhpcy5fYXV0aGVudGljYXRlQ2FyZERlbGV0ZSgpO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0RWxlbWVudCgpIHtcclxuICAgIHJldHVybiBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5jYXJkKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgX2ZpbmRMaWtlU3RhdHVzKCkge1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IHRoaXMuX2dldExpa2VkVXNlcklkcygpLmluY2x1ZGVzKHRoaXMuX3VzZXJJZCk7XHJcblxyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fdG9nZ2xlQ2FyZExpa2VCdXR0b24oKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9saXN0ZW5DYXJkTGlrZUJ1dHRvbkNsaWNrKCkge1xyXG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2VDbGljayh0aGlzLl9pZCwgdGhpcy5faXNMaWtlZCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUNhcmRMaWtlKGRhdGEpIHtcclxuICAgIHRoaXMuX3VwZGF0ZUxpa2VDb3VudChkYXRhKTtcclxuICAgIHRoaXMuX3RvZ2dsZUNhcmRMaWtlQnV0dG9uKCk7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gIXRoaXMuX2lzTGlrZWQ7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQ2FyZExpa2VCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKHNlbGVjdG9ycy5jYXJkTGlrZUJ1dHRvbkFjdGl2ZUNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9nZXRMaWtlQ291bnQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGRhdGEubGlrZXMubGVuZ3RoLnRvU3RyaW5nKCk7XHJcbiAgfVxyXG5cclxuICBfdXBkYXRlTGlrZUNvdW50KGRhdGEpIHtcclxuICAgIHRoaXMuX2NhcmRMaWtlQ291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9nZXRMaWtlQ291bnQoZGF0YSk7XHJcbiAgfVxyXG5cclxuICBfZ2V0TGlrZWRVc2VySWRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLm1hcCgobGlrZSkgPT4gbGlrZS5faWQpO1xyXG4gIH1cclxuXHJcbiAgX2F1dGhlbnRpY2F0ZUNhcmREZWxldGUoKSB7XHJcbiAgICBpZiAodGhpcy5fdXNlcklkID09IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0NhcmREZWxldGVCdXR0b24oKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zaG93Q2FyZERlbGV0ZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2NhcmREZWxldGVCdXR0b24uY2xhc3NMaXN0LmFkZChcclxuICAgICAgc2VsZWN0b3JzLmNhcmREZWxldGVCdXR0b25WaXNpYmxlQ2xhc3NcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfbGlzdGVuQ2FyZERlbGV0ZUJ1dHRvbkNsaWNrKCkge1xyXG4gICAgdGhpcy5fY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlQ2xpY2soeyBjYXJkSWQ6IHRoaXMuX2lkIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfbGlzdGVuQ2FyZEltYWdlQ2xpY2soKSB7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZEltYWdlQ2xpY2sodGhpcy5fZGF0YSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2xpc3RlbkNhcmRMaWtlQnV0dG9uQ2xpY2soKTtcclxuICAgIHRoaXMuX2xpc3RlbkNhcmREZWxldGVCdXR0b25DbGljaygpO1xyXG4gICAgdGhpcy5fbGlzdGVuQ2FyZEltYWdlQ2xpY2soKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcblxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9zZWxlY3RvciA9IHBvcHVwU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICAvLyBBcnJvdyBtZXRob2RcclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBPdmVybGF5IENsb3NlXHJcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENsb3NlIEJ1dHRvblxyXG4gICAgdGhpcy5fZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY2xvc2UtYnV0dG9uXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgc2VsZWN0b3JzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50c1wiO1xyXG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgeyBoYW5kbGVTdWJtaXQgfSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5wb3B1cEZvcm0pO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5zdWJtaXRCdXR0b24pO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uSW5pdGlhbFRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3JzLnBvcHVwSW5wdXQpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAvL2NvbGxlY3RzIGRhdGEgZnJvbSBhbGwgdGhlIGlucHV0IGZpZWxkcyBhbmQgcmV0dXJucyB0aGF0IGRhdGEgYXMgYW4gb2JqZWN0LlxyXG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAvLyBJbnNlcnQgdGhlIGB2YWx1ZWAgYnkgdGhlIGBuYW1lYCBvZiB0aGUgaW5wdXRcclxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uSW5pdGlhbFRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgLy8gU3VibWl0XHJcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlU3VibWl0KTtcclxuICB9XHJcbn1cclxuIiwiLy8gSW1wb3J0IENTUyBmb3IgV2VicGFja1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuLy8gSW1wb3J0IGNsYXNzc2VzIGFuZCBjb25zdGFudHNcclxuaW1wb3J0IHsgc2VsZWN0b3JzLCBmb3JtU2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvclwiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZVwiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaVwiO1xyXG5cclxuLy8gVmFyaWFibGUgRGVjbGFyYXRpb25zXHJcbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMuZWRpdEJ1dHRvbik7XHJcbmNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5hZGRCdXR0b24pO1xyXG5jb25zdCBlZGl0QXZhdGFyT3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLmVkaXRBdmF0YXJPdmVybGF5KTtcclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuXHJcbi8vIEZ1bmN0aW9uIERlY2xhcmF0aW9uc1xyXG5cclxuLyoqXHJcbiAqIEZpbGxzIHByb2ZpbGUgZm9ybSB3aXRoIGN1cnJlbnQgcHJvZmlsZSBpbmZvXHJcbiAqL1xyXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUZvcm0oKSB7XHJcbiAgY29uc3QgdXNlckluZm8gPSB1c2VyLmdldFVzZXJJbmZvKCk7XHJcbiAgZWRpdFByb2ZpbGVQb3B1cC5zZXRJbnB1dFZhbHVlcyh1c2VySW5mbyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGEgbmV3IGNhcmQgZWxlbWVudCB3aXRoIGdpdmVuIGRhdGEgKG5hbWUgYW5kIGltYWdlIGxpbmspXHJcbiAqXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhXHJcbiAqIEByZXR1cm5zIHtvYmplY3R9IGNhcmRFbGVtZW50XHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICB7XHJcbiAgICAgIGRhdGEsXHJcbiAgICAgIGhhbmRsZUNhcmRJbWFnZUNsaWNrOiAoaW1hZ2VEYXRhKSA9PiB7XHJcbiAgICAgICAgY2FyZFByZXZpZXdQb3B1cC5vcGVuKGltYWdlRGF0YSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGhhbmRsZUNhcmREZWxldGVDbGljazogKGNhcmRJZCkgPT4ge1xyXG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5zZXRJbnB1dFZhbHVlcyhjYXJkSWQpO1xyXG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGhhbmRsZUNhcmRMaWtlQ2xpY2s6IChjYXJkSWQsIGlzTGlrZWQpID0+IHtcclxuICAgICAgICBpc0xpa2VkXHJcbiAgICAgICAgICA/IGFwaVxyXG4gICAgICAgICAgICAgIC5kZWxldGVMaWtlKGNhcmRJZClcclxuICAgICAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY2FyZC51cGRhdGVDYXJkTGlrZShkYXRhKTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIC5jYXRjaChhcGkuaGFuZGxlRXJyb3IpXHJcbiAgICAgICAgICA6IGFwaVxyXG4gICAgICAgICAgICAgIC5hZGRMaWtlKGNhcmRJZClcclxuICAgICAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY2FyZC51cGRhdGVDYXJkTGlrZShkYXRhKTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIC5jYXRjaChhcGkuaGFuZGxlRXJyb3IpO1xyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIHNlbGVjdG9ycy5jYXJkVGVtcGxhdGVcclxuICApO1xyXG5cclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuY3JlYXRlQ2FyZCgpO1xyXG5cclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbmFibGVzIGZvcm0gdmFsaWRhdGlvbiBmb3IgYWxsIGZvcm1zIGFuZCBtYWtlcyBpdCBhY2Nlc2libGUgYnkgJ25hbWUnXHJcbiAqXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBmb3JtU2V0dGluZ3NcclxuICovXHJcbmNvbnN0IGVuYWJsZUZvcm1WYWxpZGF0aW9uID0gKGZvcm1TZXR0aW5ncykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycy5wb3B1cEZvcm0pKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVNldHRpbmdzLCBmb3JtRWxlbWVudCk7XHJcbiAgICAvLyBHZXQgdGhlIG5hbWUgb2YgdGhlIGZvcm1cclxuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuXHJcbiAgICAvLyBTdG9yZSB0aGUgdmFsaWRhdG9yIGJ5IHRoZSBgbmFtZWAgb2YgdGhlIGZvcm1cclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vLyBDcmVhdGUgaW5zdGFuY2VzIG9mIENsYXNzZXNcclxuY29uc3QgYXBpSGVhZGVycyA9IG5ldyBIZWFkZXJzKHtcclxuICBhdXRob3JpemF0aW9uOiBcImEzOTdjZDM3LTVmZmQtNGNjOS1hODBmLTk1OTk1NzgxMjNjM1wiLFxyXG4gIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG59KTtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxyXG4gIGhlYWRlcnM6IGFwaUhlYWRlcnMsXHJcbn0pO1xyXG5cclxuY29uc3QgdXNlciA9IG5ldyBVc2VySW5mbygpO1xyXG5cclxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICByZW5kZXJlcjogY3JlYXRlQ2FyZCxcclxuICB9LFxyXG4gIHNlbGVjdG9ycy5jYXJkc0NvbnRhaW5lclxyXG4pO1xyXG5cclxuY29uc3QgY2FyZFByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShzZWxlY3RvcnMucG9wdXBJbWFnZSk7XHJcblxyXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuZWRpdEF2YXRhclBvcHVwLCB7XHJcbiAgaGFuZGxlU3VibWl0OiAoZXZ0KSA9PiB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuXHJcbiAgICAvLyBEZXN0cnVjdHVyZSBhbmQgcmVhc3NpZ24gdmFsdWVzIG9iamVjdFxyXG4gICAgY29uc3QgYXZhdGFyID0gZWRpdEF2YXRhclBvcHVwLmdldElucHV0VmFsdWVzKCk7XHJcblxyXG4gICAgYXBpXHJcbiAgICAgIC5lZGl0VXNlckF2YXRhcihhdmF0YXIpXHJcbiAgICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgICAgIHVzZXIucmVuZGVyVXNlckluZm8odXNlckRhdGEpO1xyXG4gICAgICAgIGVkaXRBdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goYXBpLmhhbmRsZUVycm9yKVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgZWRpdEF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICB9KTtcclxuICB9LFxyXG59KTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuZWRpdFByb2ZpbGVQb3B1cCwge1xyXG4gIGhhbmRsZVN1Ym1pdDogKGV2dCkgPT4ge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgZWRpdFByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG5cclxuICAgIC8vIERlc3RydWN0dXJlIGFuZCByZWFzc2lnbiB2YWx1ZXMgb2JqZWN0XHJcbiAgICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSBlZGl0UHJvZmlsZVBvcHVwLmdldElucHV0VmFsdWVzKCk7XHJcblxyXG4gICAgYXBpXHJcbiAgICAgIC5lZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KVxyXG4gICAgICAudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgICAgICB1c2VyLnJlbmRlclVzZXJJbmZvKHVzZXJEYXRhKTtcclxuICAgICAgICBlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChhcGkuaGFuZGxlRXJyb3IpXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBlZGl0UHJvZmlsZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICB9KTtcclxuICB9LFxyXG59KTtcclxuXHJcbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHNlbGVjdG9ycy5kZWxldGVDYXJkUG9wdXAsIHtcclxuICBoYW5kbGVTdWJtaXQ6IChldnQpID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIC8vRmluZCBhbmQgZGVsZXRlIHRoZSBjYXJkXHJcbiAgICBjb25zdCB7IGNhcmRJZCB9ID0gZGVsZXRlQ2FyZFBvcHVwLmdldElucHV0VmFsdWVzKCk7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhcmRJZCk7XHJcblxyXG4gICAgYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goYXBpLmhhbmRsZUVycm9yKTtcclxuICB9LFxyXG59KTtcclxuXHJcbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHNlbGVjdG9ycy5hZGRDYXJkUG9wdXAsIHtcclxuICBoYW5kbGVTdWJtaXQ6IChldnQpID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgYWRkQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJDcmVhdGluZy4uLlwiKTtcclxuXHJcbiAgICAvLyBEZXN0cnVjdHVyZSBhbmQgcmVhc3NpZ24gdmFsdWVzIG9iamVjdFxyXG4gICAgY29uc3QgeyBuYW1lLCBsaW5rIH0gPSBhZGRDYXJkUG9wdXAuZ2V0SW5wdXRWYWx1ZXMoKTtcclxuXHJcbiAgICBhcGlcclxuICAgICAgLmFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pXHJcbiAgICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZERhdGEpO1xyXG4gICAgICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goYXBpLmhhbmRsZUVycm9yKVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgYWRkQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICB9KTtcclxuICB9LFxyXG59KTtcclxuXHJcbi8vIEluaXRpYWxpemUgY2xhc3MgaW5zdGFuY2VzXHJcbmFwaVxyXG4gIC5nZXRBcHBJbmZvKClcclxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc0RhdGFdKSA9PiB7XHJcbiAgICB1c2VyLnJlbmRlclVzZXJJbmZvKHVzZXJEYXRhKTtcclxuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzRGF0YSk7XHJcbiAgfSlcclxuICAuY2F0Y2goYXBpLmhhbmRsZUVycm9yKTtcclxuXHJcbmNhcmRQcmV2aWV3UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuZWRpdEF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gRW5hYmxlIEZvcm0gVmFsaWRhdGlvblxyXG5lbmFibGVGb3JtVmFsaWRhdGlvbihmb3JtU2V0dGluZ3MpO1xyXG5cclxuLy8gQnV0dG9uIENsaWNrIEV2ZW50IExpc3RlbmVyc1xyXG5lZGl0QXZhdGFyT3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW3NlbGVjdG9ycy5hdmF0YXJGb3JtTmFtZV0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW3NlbGVjdG9ycy5wcm9maWxlRm9ybU5hbWVdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGZpbGxQcm9maWxlRm9ybSgpO1xyXG4gIGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tzZWxlY3RvcnMuY2FyZEZvcm1OYW1lXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG59KTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9oYW5kbGVTZXJ2ZXJSZXNwb25zZShyZXMpIHtcclxuICAgIHJldHVybiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1cyk7XHJcbiAgfVxyXG5cclxuICBfcmVxdWVzdCh1cmwsIG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlRXJyb3IoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBjYXVnaHQgaW4gZmV0Y2ggQVBJOiAke2Vycn1gKTtcclxuICB9XHJcblxyXG4gIF9nZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuX2dldFVzZXJJbmZvKCksIHRoaXMuX2dldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZExpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGF2YXRhciksXHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgc2VsZWN0b3JzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50c1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5fdXNlck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy51c2VyTmFtZSk7XHJcbiAgICB0aGlzLl91c2VyQWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy51c2VyQWJvdXQpO1xyXG4gICAgdGhpcy5fdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLnVzZXJBdmF0YXIpO1xyXG4gICAgdGhpcy5fdXNlckluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy51c2VySW5mbyk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IG5hbWUgPSB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudDtcclxuICAgIGNvbnN0IGFib3V0ID0gdGhpcy5fdXNlckFib3V0LnRleHRDb250ZW50O1xyXG5cclxuICAgIHJldHVybiB7IG5hbWUsIGFib3V0IH07XHJcbiAgfVxyXG5cclxuICByZW5kZXJVc2VySW5mbyh7IG5hbWUsIGFib3V0LCBhdmF0YXIsIF9pZCB9KSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl91c2VyQWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gICAgdGhpcy5fdXNlckluZm8uaWQgPSBfaWQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgaXRlbXMucmV2ZXJzZSgpLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5hZGRJdGVtKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIGNvbnN0IHJlbmRlcmVkSXRlbSA9IHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgdGhpcy5fZWxlbWVudC5wcmVwZW5kKHJlbmRlcmVkSXRlbSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9zdWJ0aXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc3VidGl0bGVcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKGltYWdlRGF0YSkge1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gaW1hZ2VEYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBgSW1hZ2UgJHtpbWFnZURhdGEubmFtZX1gO1xyXG4gICAgdGhpcy5fc3VidGl0bGUudGV4dENvbnRlbnQgPSBpbWFnZURhdGEubmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbInNlbGVjdG9ycyIsIkNhcmQiLCJjb25zdHJ1Y3RvciIsInRlbXBsYXRlU2VsZWN0b3IiLCJkYXRhIiwiaGFuZGxlQ2FyZEltYWdlQ2xpY2siLCJoYW5kbGVDYXJkRGVsZXRlQ2xpY2siLCJoYW5kbGVDYXJkTGlrZUNsaWNrIiwidGhpcyIsIl9kYXRhIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfaWQiLCJfdXNlcklkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZEltYWdlQ2xpY2siLCJfaGFuZGxlQ2FyZERlbGV0ZUNsaWNrIiwiX2hhbmRsZUNhcmRMaWtlQ2xpY2siLCJjcmVhdGVDYXJkIiwiX2NhcmQiLCJfZ2V0RWxlbWVudCIsIl9jYXJkTmFtZSIsIl9jYXJkSW1hZ2UiLCJfY2FyZExpa2VCdXR0b24iLCJfY2FyZExpa2VDb3VudCIsIl9jYXJkRGVsZXRlQnV0dG9uIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJfZ2V0TGlrZUNvdW50IiwiX2ZpbmRMaWtlU3RhdHVzIiwiX2F1dGhlbnRpY2F0ZUNhcmREZWxldGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2lzTGlrZWQiLCJfZ2V0TGlrZWRVc2VySWRzIiwiaW5jbHVkZXMiLCJfdG9nZ2xlQ2FyZExpa2VCdXR0b24iLCJfbGlzdGVuQ2FyZExpa2VCdXR0b25DbGljayIsImFkZEV2ZW50TGlzdGVuZXIiLCJ1cGRhdGVDYXJkTGlrZSIsIl91cGRhdGVMaWtlQ291bnQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJsZW5ndGgiLCJ0b1N0cmluZyIsIm1hcCIsImxpa2UiLCJfc2hvd0NhcmREZWxldGVCdXR0b24iLCJhZGQiLCJfbGlzdGVuQ2FyZERlbGV0ZUJ1dHRvbkNsaWNrIiwiY2FyZElkIiwiX2xpc3RlbkNhcmRJbWFnZUNsaWNrIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfc2V0dGluZ3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZW5hYmxlVmFsaWRhdGlvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwicmVzZXRWYWxpZGF0aW9uIiwiX2hpZGVJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJfc2VsZWN0b3IiLCJfZWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlU3VibWl0IiwiX2Zvcm0iLCJfc3VibWl0QnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbkluaXRpYWxUZXh0IiwicmVzZXQiLCJnZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsImVkaXRQcm9maWxlQnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsImVkaXRBdmF0YXJPdmVybGF5IiwiZm9ybVZhbGlkYXRvcnMiLCJhcGlIZWFkZXJzIiwiSGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlU2VydmVyUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJ0aGVuIiwiaGFuZGxlRXJyb3IiLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJfZ2V0VXNlckluZm8iLCJfZ2V0SW5pdGlhbENhcmRzIiwiZ2V0QXBwSW5mbyIsImFsbCIsImVkaXRVc2VySW5mbyIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGROZXdDYXJkIiwiZGVsZXRlQ2FyZCIsImFkZExpa2UiLCJkZWxldGVMaWtlIiwiZWRpdFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJ1c2VyIiwiX3VzZXJOYW1lIiwiX3VzZXJBYm91dCIsIl91c2VyQXZhdGFyIiwiX3VzZXJJbmZvIiwiZ2V0VXNlckluZm8iLCJyZW5kZXJVc2VySW5mbyIsImNhcmRTZWN0aW9uIiwic2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJyZXZlcnNlIiwiaXRlbSIsImFkZEl0ZW0iLCJyZW5kZXJlZEl0ZW0iLCJwcmVwZW5kIiwiY2FyZCIsImltYWdlRGF0YSIsImNhcmRQcmV2aWV3UG9wdXAiLCJkZWxldGVDYXJkUG9wdXAiLCJpc0xpa2VkIiwiY2F0Y2giLCJfaW1hZ2UiLCJfc3VidGl0bGUiLCJlZGl0QXZhdGFyUG9wdXAiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJEYXRhIiwiZmluYWxseSIsImVkaXRQcm9maWxlUG9wdXAiLCJjYXJkRWxlbWVudCIsImdldEVsZW1lbnRCeUlkIiwiYWRkQ2FyZFBvcHVwIiwiY2FyZERhdGEiLCJmb3JtU2V0dGluZ3MiLCJjYXJkc0RhdGEiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsInVzZXJJbmZvIiwiZmlsbFByb2ZpbGVGb3JtIl0sInNvdXJjZVJvb3QiOiIifQ==